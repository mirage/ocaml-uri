(* Autogenerated by gen_services.ml, do not edit directly *)
let tcp_port_of_service = function
  |"9pfs" -> [564]
  |"acap" -> [674]
  |"auth" -> [113]
  |"bgp" -> [179]
  |"bootpc" -> [68]
  |"bootps" -> [67]
  |"chargen" -> [19]
  |"daytime" -> [13]
  |"dctp" -> [675]
  |"dhcpv6-client" -> [546]
  |"dhcpv6-server" -> [547]
  |"discard" -> [9]
  |"domain" -> [53]
  |"echo" -> [7]
  |"efs" -> [520]
  |"finger" -> [79]
  |"ftp" -> [21]
  |"ftp-data" -> [20]
  |"ftps" -> [990]
  |"ftps-data" -> [989]
  |"genrad-mux" -> [176]
  |"git" -> [9418]
  |"gopher" -> [70]
  |"http" -> [80]
  |"https" -> [443]
  |"ident" -> [113]
  |"imap" -> [143]
  |"imap4-ssl" -> [585]
  |"imaps" -> [993]
  |"ipx" -> [213]
  |"irc" -> [194]
  |"irc-serv" -> [529]
  |"ircs" -> [994]
  |"kerberos" -> [88]
  |"kerberos-adm" -> [749]
  |"keyserver" -> [584]
  |"klogin" -> [543]
  |"kpasswd" -> [464]
  |"kshell" -> [544]
  |"ldap" -> [389]
  |"msp" -> [18]
  |"netbios-dgm" -> [138]
  |"netbios-ns" -> [137]
  |"netbios-ssn" -> [139]
  |"nmap" -> [689]
  |"nntp" -> [119]
  |"ntalk" -> [518]
  |"ntp" -> [123]
  |"pirp" -> [553]
  |"pop3" -> [110]
  |"pop3s" -> [995]
  |"printer" -> [515]
  |"qmtp" -> [209]
  |"rsync" -> [873]
  |"rtsp" -> [554]
  |"silc" -> [706]
  |"smtp" -> [25]
  |"ssh" -> [22]
  |"sunrpc" -> [111]
  |"syslog-conn" -> [601]
  |"systat" -> [11]
  |"talk" -> [517]
  |"telnet" -> [23]
  |"telnets" -> [992]
  |"tftp" -> [69]
  |"time" -> [37]
  |"utime" -> [519]
  |"www" -> [80]
  |"www-http" -> [80]
  |"xdmcp" -> [177]
  |_ -> []

let udp_port_of_service = function
  |"9pfs" -> [564]
  |"acap" -> [674]
  |"auth" -> [113]
  |"bgp" -> [179]
  |"bootpc" -> [68]
  |"bootps" -> [67]
  |"daytime" -> [13]
  |"dctp" -> [675]
  |"dhcpv6-client" -> [546]
  |"dhcpv6-server" -> [547]
  |"discard" -> [9]
  |"domain" -> [53]
  |"echo" -> [7]
  |"finger" -> [79]
  |"ftp" -> [21]
  |"ftp-data" -> [20]
  |"ftps" -> [990]
  |"ftps-data" -> [989]
  |"git" -> [9418]
  |"gopher" -> [70]
  |"http" -> [80]
  |"https" -> [443]
  |"imap" -> [143]
  |"imap4-ssl" -> [585]
  |"imaps" -> [993]
  |"ipx" -> [213]
  |"irc" -> [194]
  |"irc-serv" -> [529]
  |"ircs" -> [994]
  |"kerberos" -> [88]
  |"kerberos-adm" -> [749]
  |"keyserver" -> [584]
  |"klogin" -> [543]
  |"kpasswd" -> [464]
  |"kshell" -> [544]
  |"ldap" -> [389]
  |"msp" -> [18]
  |"netbios-dgm" -> [138]
  |"netbios-ns" -> [137]
  |"netbios-ssn" -> [139]
  |"nmap" -> [689]
  |"nntp" -> [119]
  |"ntalk" -> [518]
  |"ntp" -> [123]
  |"pirp" -> [553]
  |"pop3" -> [110]
  |"pop3s" -> [995]
  |"printer" -> [515]
  |"qmtp" -> [209]
  |"rsync" -> [873]
  |"rtsp" -> [554]
  |"silc" -> [706]
  |"smtp" -> [25]
  |"ssh" -> [22]
  |"sunrpc" -> [111]
  |"syslog" -> [514]
  |"syslog-conn" -> [601]
  |"systat" -> [11]
  |"talk" -> [517]
  |"telnet" -> [23]
  |"telnets" -> [992]
  |"tftp" -> [69]
  |"time" -> [37]
  |"utime" -> [519]
  |"www" -> [80]
  |"www-http" -> [80]
  |"xdmcp" -> [177]
  |_ -> []

let service_of_tcp_port = function
  |7 -> ["echo"]
  |9 -> ["discard"]
  |11 -> ["systat"]
  |13 -> ["daytime"]
  |18 -> ["msp"]
  |19 -> ["chargen"]
  |20 -> ["ftp-data"]
  |21 -> ["ftp"]
  |22 -> ["ssh"]
  |23 -> ["telnet"]
  |25 -> ["smtp"]
  |37 -> ["time"]
  |53 -> ["domain"]
  |67 -> ["bootps"]
  |68 -> ["bootpc"]
  |69 -> ["tftp"]
  |70 -> ["gopher"]
  |79 -> ["finger"]
  |80 -> ["www-http";"www";"http"]
  |88 -> ["kerberos"]
  |110 -> ["pop3"]
  |111 -> ["sunrpc"]
  |113 -> ["ident";"auth"]
  |119 -> ["nntp"]
  |123 -> ["ntp"]
  |137 -> ["netbios-ns"]
  |138 -> ["netbios-dgm"]
  |139 -> ["netbios-ssn"]
  |143 -> ["imap"]
  |176 -> ["genrad-mux"]
  |177 -> ["xdmcp"]
  |179 -> ["bgp"]
  |194 -> ["irc"]
  |209 -> ["qmtp"]
  |213 -> ["ipx"]
  |389 -> ["ldap"]
  |443 -> ["https"]
  |464 -> ["kpasswd"]
  |515 -> ["printer"]
  |517 -> ["talk"]
  |518 -> ["ntalk"]
  |519 -> ["utime"]
  |520 -> ["efs"]
  |529 -> ["irc-serv"]
  |543 -> ["klogin"]
  |544 -> ["kshell"]
  |546 -> ["dhcpv6-client"]
  |547 -> ["dhcpv6-server"]
  |553 -> ["pirp"]
  |554 -> ["rtsp"]
  |564 -> ["9pfs"]
  |584 -> ["keyserver"]
  |585 -> ["imap4-ssl"]
  |601 -> ["syslog-conn"]
  |674 -> ["acap"]
  |675 -> ["dctp"]
  |689 -> ["nmap"]
  |706 -> ["silc"]
  |749 -> ["kerberos-adm"]
  |873 -> ["rsync"]
  |989 -> ["ftps-data"]
  |990 -> ["ftps"]
  |992 -> ["telnets"]
  |993 -> ["imaps"]
  |994 -> ["ircs"]
  |995 -> ["pop3s"]
  |9418 -> ["git"]
  |_ -> []

let service_of_udp_port = function
  |7 -> ["echo"]
  |9 -> ["discard"]
  |11 -> ["systat"]
  |13 -> ["daytime"]
  |18 -> ["msp"]
  |20 -> ["ftp-data"]
  |21 -> ["ftp"]
  |22 -> ["ssh"]
  |23 -> ["telnet"]
  |25 -> ["smtp"]
  |37 -> ["time"]
  |53 -> ["domain"]
  |67 -> ["bootps"]
  |68 -> ["bootpc"]
  |69 -> ["tftp"]
  |70 -> ["gopher"]
  |79 -> ["finger"]
  |80 -> ["www-http";"www";"http"]
  |88 -> ["kerberos"]
  |110 -> ["pop3"]
  |111 -> ["sunrpc"]
  |113 -> ["auth"]
  |119 -> ["nntp"]
  |123 -> ["ntp"]
  |137 -> ["netbios-ns"]
  |138 -> ["netbios-dgm"]
  |139 -> ["netbios-ssn"]
  |143 -> ["imap"]
  |177 -> ["xdmcp"]
  |179 -> ["bgp"]
  |194 -> ["irc"]
  |209 -> ["qmtp"]
  |213 -> ["ipx"]
  |389 -> ["ldap"]
  |443 -> ["https"]
  |464 -> ["kpasswd"]
  |514 -> ["syslog"]
  |515 -> ["printer"]
  |517 -> ["talk"]
  |518 -> ["ntalk"]
  |519 -> ["utime"]
  |529 -> ["irc-serv"]
  |543 -> ["klogin"]
  |544 -> ["kshell"]
  |546 -> ["dhcpv6-client"]
  |547 -> ["dhcpv6-server"]
  |553 -> ["pirp"]
  |554 -> ["rtsp"]
  |564 -> ["9pfs"]
  |584 -> ["keyserver"]
  |585 -> ["imap4-ssl"]
  |601 -> ["syslog-conn"]
  |674 -> ["acap"]
  |675 -> ["dctp"]
  |689 -> ["nmap"]
  |706 -> ["silc"]
  |749 -> ["kerberos-adm"]
  |873 -> ["rsync"]
  |989 -> ["ftps-data"]
  |990 -> ["ftps"]
  |992 -> ["telnets"]
  |993 -> ["imaps"]
  |994 -> ["ircs"]
  |995 -> ["pop3s"]
  |9418 -> ["git"]
  |_ -> []

let known_tcp_services =
  [ "ftp";"https";"kpasswd";"imap4-ssl";"echo";"netbios-ssn";"www";"pop3";"bgp";"keyserver";"tftp";"rsync";"qmtp";"talk";"kerberos-adm";"ssh";"time";"syslog-conn";"telnets";"printer";"systat";"git";"www-http";"irc-serv";"ldap";"9pfs";"sunrpc";"xdmcp";"kerberos";"genrad-mux";"ident";"pop3s";"pirp";"nntp";"imap";"domain";"netbios-ns";"dctp";"daytime";"msp";"efs";"ftp-data";"http";"kshell";"rtsp";"ftps-data";"chargen";"smtp";"irc";"bootps";"acap";"dhcpv6-client";"finger";"utime";"imaps";"netbios-dgm";"ntp";"nmap";"telnet";"klogin";"silc";"dhcpv6-server";"ircs";"gopher";"auth";"ntalk";"discard";"bootpc";"ipx";"ftps" ]

let known_udp_services =
  [ "ftp";"https";"kpasswd";"imap4-ssl";"echo";"netbios-ssn";"www";"pop3";"bgp";"keyserver";"tftp";"rsync";"qmtp";"talk";"kerberos-adm";"ssh";"time";"syslog-conn";"telnets";"printer";"systat";"git";"www-http";"irc-serv";"ldap";"9pfs";"sunrpc";"xdmcp";"kerberos";"pop3s";"pirp";"nntp";"imap";"domain";"netbios-ns";"syslog";"dctp";"daytime";"msp";"ftp-data";"http";"kshell";"rtsp";"ftps-data";"smtp";"irc";"bootps";"acap";"dhcpv6-client";"finger";"utime";"imaps";"netbios-dgm";"ntp";"nmap";"telnet";"klogin";"silc";"dhcpv6-server";"ircs";"gopher";"auth";"ntalk";"discard";"bootpc";"ipx";"ftps" ]

let known_services = [
  ("tcp", known_tcp_services);
  ("udp", known_udp_services) ]

let port_of_uri ?default lookupfn uri =
  match Uri.port uri with
  |Some port as x -> x
  |None -> begin
    match Uri.scheme uri, default with
    |None, None -> None
    |None, Some scheme
    |Some scheme, _ -> begin
      match lookupfn scheme with
      |[] -> None
      |hd::_ -> Some hd
     end
  end

let tcp_port_of_uri ?default uri =
  port_of_uri ?default tcp_port_of_service uri

let udp_port_of_uri ?default uri =
  port_of_uri ?default udp_port_of_service uri
